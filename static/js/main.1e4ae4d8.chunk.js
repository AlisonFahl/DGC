(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{184:function(e,t,n){e.exports=n(424)},189:function(e,t,n){},190:function(e,t,n){},191:function(e,t,n){},192:function(e,t,n){},206:function(e,t){},229:function(e,t){},231:function(e,t){},278:function(e,t){},280:function(e,t){},309:function(e,t){},418:function(e,t,n){},419:function(e,t,n){},420:function(e,t,n){},421:function(e,t,n){},422:function(e,t,n){},424:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(19),r=n.n(i),s=(n(189),n(103)),c=n(181),l=n(25),u=n(44),m=n(183),p=n(11),h=n(12),f=n(14),d=n(13),b=(n(190),n(191),n(177)),g=n.n(b),y=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=new Intl.DateTimeFormat("default",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"});return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.a,null,o.a.createElement(l.a,{sm:12,md:3,lg:2},o.a.createElement("div",{style:{textAlign:"center"},title:this.props.address},o.a.createElement(g.a,{size:"42",string:this.props.address}))),o.a.createElement(l.a,null,o.a.createElement(u.a,null,o.a.createElement(l.a,{sm:12},o.a.createElement("h6",null,o.a.createElement("strong",null,this.props.alias))),o.a.createElement(l.a,{sm:12},o.a.createElement("small",{className:"text-muted"},e.format(this.props.date)))))),o.a.createElement(u.a,null,o.a.createElement(l.a,null,o.a.createElement("p",null,this.props.text))))}}]),n}(o.a.Component),E=(n(192),n(27)),v=n(104),C=n(182),w=n(102),j=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).ALIAS_CHAR_LIMIT=30,e.MESSAGE_CHAR_LIMIT=280,e.handleSubmit=function(t){e.isFormValid()&&e.props.postComment({alias:e.state.alias,message:e.state.message}),t.preventDefault()},e.isFormValid=function(){return e.getCharsLeft(e.state.alias,e.ALIAS_CHAR_LIMIT)>=0&&e.getCharsLeft(e.state.message,e.MESSAGE_CHAR_LIMIT)>=0},e.state={alias:"",message:""},e.wrapper=o.a.createRef(),e}return Object(h.a)(n,[{key:"getCharsLeft",value:function(e,t){return t-e.length}},{key:"renderTooltip",value:function(e){return o.a.createElement(w.a,Object.assign({id:"button-tooltip"},e),"Simple tooltip")}},{key:"render",value:function(){var e=this;return o.a.createElement(E.a,{onSubmit:this.handleSubmit},o.a.createElement(E.a.Group,{controlId:"formAlias"},o.a.createElement(E.a.Label,null,"Alias:"),o.a.createElement(E.a.Control,{onChange:function(t){e.setState({alias:t.target.value})},isInvalid:this.getCharsLeft(this.state.alias,this.ALIAS_CHAR_LIMIT)<0,type:"text",placeholder:"Choose an alias (leave it empty for posting anonymously)"}),o.a.createElement(E.a.Text,{className:"text-muted"},this.getCharsLeft(this.state.alias,this.ALIAS_CHAR_LIMIT).toString()," chars left")),o.a.createElement(E.a.Group,{controlId:"formMessage"},o.a.createElement(E.a.Label,null,"Message:"),o.a.createElement(E.a.Control,{onChange:function(t){e.setState({message:t.target.value})},isInvalid:this.getCharsLeft(this.state.message,this.MESSAGE_CHAR_LIMIT)<0,as:"textarea",placeholder:"Type Message..."}),o.a.createElement(E.a.Text,{className:"text-muted"},this.getCharsLeft(this.state.message,this.MESSAGE_CHAR_LIMIT).toString()," chars left")),this.props.canSubmit?o.a.createElement(v.a,{variant:"dark",type:"submit"},"Submit"):o.a.createElement(C.a,{overlay:o.a.createElement(w.a,{id:"tooltip-disabled"},"No web3 provider found in your browser for this page")},o.a.createElement("span",{ref:this.wrapper,className:"d-inline-block"},o.a.createElement(v.a,{variant:"outline-dark",type:"submit",disabled:!0,style:{pointerEvents:"none"}},"Submit"))))}}]),n}(o.a.Component),O=n(75),S=n.n(O),I=window.ethereum?k(window.ethereum):window.web3?k(window.web3.currentProvider):new S.a(new S.a.providers.HttpProvider("https://mainnet.infura.io/v3/172179b931884f65be39cadc9a9536f7"));function k(e){return new S.a(e)}var A=new I.eth.Contract([{constant:!1,inputs:[{name:"message",type:"string"},{name:"_alias",type:"string"}],name:"post",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"messages",outputs:[{name:"message",type:"string"},{name:"sender",type:"address"},{name:"senderAlias",type:"string"},{name:"timestamp",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getTotalMessages",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],"0x764F00cfD053feFC7978a3F81D4F62102E8393eF"),M=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"postMessage",value:function(e,t){var n=this;return new Promise((function(a,o){n.getAccount().then((function(n){A.methods.post(e,t).send({from:n}).then(a).catch(o)})).catch(o)}))}},{key:"getTotalMessages",value:function(){return A.methods.getTotalMessages().call()}},{key:"getMessage",value:function(e){return A.methods.messages(e).call()}}]),n}(function(){function e(){Object(p.a)(this,e)}return Object(h.a)(e,[{key:"getAccount",value:function(){return new Promise((function(e,t){window.ethereum?window.ethereum.enable().then((function(){I.eth.getAccounts().then((function(t){return e(t[0])})).catch(t)})).catch(t):I.eth.getAccounts().then((function(t){return e(t[0])})).catch(t)}))}}]),e}()),x=(n(418),n(419),n(420),n(76)),N=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return o.a.createElement(x.a,{className:"".concat(this.props.bgColor," ").concat(this.props.textColor),delay:this.props.delay,onClose:this.props.onClose,autohide:this.props.autohide},o.a.createElement(x.a.Header,{className:"bg-dark text-white"},o.a.createElement("strong",{className:"mr-auto"},this.props.title)),o.a.createElement(x.a.Body,null,this.props.children))}}]),n}(o.a.Component),L=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return o.a.createElement(N,{title:"Error",bgColor:"bg-danger",textColor:"text-white",delay:this.props.delay,onClose:this.props.onClose,autohide:this.props.autohide},o.a.createElement("div",null,this.props.message))}}]),n}(o.a.Component),T=(n(421),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return o.a.createElement(N,{title:"Info",bgColor:"bg-info",textColor:"text-white",delay:this.props.delay,onClose:this.props.onClose,autohide:this.props.autohide},o.a.createElement("div",null,this.props.message))}}]),n}(o.a.Component)),_=(n(422),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return o.a.createElement(N,{title:"Success",bgColor:"bg-success",textColor:"text-white",delay:this.props.delay,onClose:this.props.onClose,autohide:this.props.autohide},o.a.createElement("div",null,this.props.message))}}]),n}(o.a.Component)),H=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{position:"fixed",top:50,right:0}},this.props.notifications.map((function(t){var n={key:t.key,message:t.message,delay:t.delay,autohide:t.delay>0,onClose:function(){return e.props.onHideNotification(t.key)}};switch(t.type){case"Error":return o.a.createElement(L,n);case"Info":return o.a.createElement(T,n);case"Success":return o.a.createElement(_,n);default:throw new Error("Invalid Notification Type")}})))}}]),n}(o.a.Component),F=o.a.createContext(),R=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).onShowNotification=function(t,n,a){e.state.notifications.push({key:++e.notificationCount,type:t,message:n,delay:a}),e.setState({notifications:e.state.notifications})},e.onHideNotification=function(t){e.setState({notifications:e.state.notifications.filter((function(e){return e.key!==t}))})},e.state={notifications:[]},e.notificationCount=0,e}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t={notification:{error:function(t,n){e.onShowNotification("Error",t,n)},info:function(t,n){e.onShowNotification("Info",t,n)},success:function(t,n){e.onShowNotification("Success",t,n)}}};return o.a.createElement(F.Provider,{value:t},this.props.children,o.a.createElement(H,{notifications:this.state.notifications,onHideNotification:this.onHideNotification}))}}]),n}(o.a.Component),D=F,G=n(179),P=n(180),B=n(60),z=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).postComment=function(t){e.context.notification.info(o.a.createElement("div",null,o.a.createElement(G.a,{size:"sm",animation:"border",variant:"dark"}),o.a.createElement("span",{style:{marginLeft:"10px"}},"Posting new comment...")),5e3),e.service.postMessage(t.message,t.alias).then((function(){e.context.notification.success("Comment posted with success!",3e3),e.fetchNewComments()})).catch((function(){e.context.notification.error("Error posting new comment",3e3)}))},e.loadComment=function(t){e.service.getMessage(t).then((function(n){e.setState((function(e,a){return e.comments.some((function(e){return e.id===t}))?{}:{comments:[{id:t,alias:n.senderAlias,text:n.message,date:new Date(1e3*parseInt(n.timestamp)),address:n.sender}].concat(Object(m.a)(e.comments)).sort((function(e,t){return t.id-e.id}))}}))}))},e.fetchNewComments=function(){e.service.getTotalMessages().then((function(t){t=parseInt(t);for(var n=function(t){e.state.comments.some((function(e){return e.id===t}))||e.loadComment(t)},a=0;a<t;a++)n(a)}))},e.state={comments:[],canSubmit:!1},e.service=new M,e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.setState({canSubmit:window.ethereum||window.web3}),this.fetchNewCommentsTaskId=window.setInterval(this.fetchNewComments,3e4),this.fetchNewComments()}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.fetchNewCommentsTaskId)}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(P.a,null,o.a.createElement(B.a,{border:"white",className:"card"},o.a.createElement(B.a.Body,null,o.a.createElement(j,{postComment:this.postComment,canSubmit:this.state.canSubmit}))),this.state.comments.length>0&&this.state.comments.map((function(e){return o.a.createElement(B.a,{key:e.id,border:"white",className:"card"},o.a.createElement(B.a.Body,null,o.a.createElement(y,e)))}))))}}]),n}(o.a.Component);z.contextType=D;var J=z;var V=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{bg:"dark",variant:"dark"},o.a.createElement(s.a.Brand,null,"Decentralized Global Chat")),o.a.createElement(c.a,{fluid:!0},o.a.createElement(R,null,o.a.createElement(u.a,null,o.a.createElement(l.a,null,o.a.createElement(J,null))))))};n(423);r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(V,null)),document.getElementById("root"))}},[[184,1,2]]]);
//# sourceMappingURL=main.1e4ae4d8.chunk.js.map